(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{254:function(a,t,s){"use strict";s.r(t);var e=s(19),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"string"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#string"}},[a._v("#")]),a._v(" String")]),a._v(" "),s("h3",{attrs:{id:"单值缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单值缓存"}},[a._v("#")]),a._v(" 单值缓存")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET key value\nGET key\n")])])]),s("h3",{attrs:{id:"对象缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对象缓存"}},[a._v("#")]),a._v(" 对象缓存")]),a._v(" "),s("ol",[s("li")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET user:1 value(json格式数据)\n")])])]),s("ol",{attrs:{start:"2"}},[s("li")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("MSET user:1:name yinjinbiao user:1:age 24\nMGET user:1:name user:1:age\n")])])]),s("h3",{attrs:{id:"分布式锁"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分布式锁"}},[a._v("#")]),a._v(" 分布式锁")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SETNX product:10001 true //返回1代表获取锁成功\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SETNX product:10001 false //返回0代表获取锁失败\n")])])]),s("p",[a._v("执行业务操作...")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("DEL product:10001 //执行完业务释放锁\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SET product:10001 true ex 10 nx //防止程序意外终止发生死锁\n")])])]),s("h3",{attrs:{id:"计数器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#计数器"}},[a._v("#")]),a._v(" 计数器")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("INCR article:readcount:{文章id}\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GET article:readcount:{文章id}\n")])])]),s("h3",{attrs:{id:"web-集群-session-共享"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#web-集群-session-共享"}},[a._v("#")]),a._v(" Web 集群 session 共享")]),a._v(" "),s("p",[a._v("spring session + redis 实现 session 共享")]),a._v(" "),s("h3",{attrs:{id:"分布式系统全局序列号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分布式系统全局序列号"}},[a._v("#")]),a._v(" 分布式系统全局序列号")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("INCRBY orderId 1000 //redis批量生成序列id，整型自增 id，提升性能\n")])])]),s("h2",{attrs:{id:"hash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hash"}},[a._v("#")]),a._v(" Hash")]),a._v(" "),s("h3",{attrs:{id:"对象缓存-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对象缓存-2"}},[a._v("#")]),a._v(" 对象缓存")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("HMSET user 1:name yinjinbiao 1:age 24\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("HMGET user 1:name 1:age \n")])])]),s("h3",{attrs:{id:"电商购物车"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#电商购物车"}},[a._v("#")]),a._v(" 电商购物车")]),a._v(" "),s("ol",[s("li",[a._v("以用户id为key")]),a._v(" "),s("li",[a._v("商品id为field")]),a._v(" "),s("li",[a._v("商品数量为value")])]),a._v(" "),s("p",[a._v("购物车操作：")]),a._v(" "),s("ol",[s("li",[a._v("添加商品 , 设置id为1001的用户添加1个id为10088的商品")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hset cart:1001 10088 1\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("增加数量 , 商品数量+1")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hincrby cart:1001 10088 1\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("获取商品总数")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hlen cart:1001 10088\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("删除商品")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hdel cart:1001 10088\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[a._v("获取商品总数")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("hgetall cart:1001\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[a._v("TIP")]),a._v(" "),s("p",[a._v("优点")]),a._v(" "),s("ul",[s("li",[a._v("同类数据归类整合储存，方便数据管理")]),a._v(" "),s("li",[a._v("相比string操作消耗内存与cpu更小")]),a._v(" "),s("li",[a._v("相比string储存更省空间")])]),a._v(" "),s("p",[a._v("缺点")]),a._v(" "),s("ul",[s("li",[a._v("过期功能不能使用在field，只能用在key上面")]),a._v(" "),s("li",[a._v("Redis集群架构下不适合大规模使用，集群数据倾斜，导致某一key数据过多压力过大。")])])]),a._v(" "),s("h2",{attrs:{id:"list"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#list"}},[a._v("#")]),a._v(" List")]),a._v(" "),s("p",[a._v("可以实现的消息结构：")]),a._v(" "),s("ul",[s("li",[a._v("Stack（栈） = LPUSH + LPOP")]),a._v(" "),s("li",[a._v("Queue（队列） = LPUSH + RPOP")]),a._v(" "),s("li",[a._v("Blocking MQ（阻塞队列） = LPUSH +BRPOP")])]),a._v(" "),s("h3",{attrs:{id:"微博和微信公众号消息流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微博和微信公众号消息流"}},[a._v("#")]),a._v(" 微博和微信公众号消息流")]),a._v(" "),s("p",[a._v("我关注了程序员训练营")]),a._v(" "),s("ol",[s("li",[a._v("程序员训练营发微博，消息ID为10018")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("LPUSH msg:{我的id} 10018\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("查看最新微博消息， 返回0-5的消息")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("LRANGE msg:{我的id} 0 5\n")])])]),s("h2",{attrs:{id:"set"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#set"}},[a._v("#")]),a._v(" Set")]),a._v(" "),s("h3",{attrs:{id:"微信抽奖小程序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信抽奖小程序"}},[a._v("#")]),a._v(" 微信抽奖小程序")]),a._v(" "),s("ol",[s("li",[a._v("点击参与抽奖，向活动101奖池中添加id为10001的用户")])]),a._v(" "),s("p",[a._v("sadd act:101 10001")]),a._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[a._v("查看所有抽奖用户")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SMEMBERS act:101\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("随机抽奖，中奖用户不从奖池删除")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SRANDMEMBER act:101\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("随机抽奖，中奖用户删除")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SPOP act:101\n")])])]),s("h3",{attrs:{id:"微信微博点赞，收藏"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#微信微博点赞，收藏"}},[a._v("#")]),a._v(" 微信微博点赞，收藏")]),a._v(" "),s("ol",[s("li",[a._v("点赞")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SADD like:{消息id} {用户id}\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("取消点赞")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SREM like:{消息id} {用户id}\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("检查用户是否点过赞")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SISMEMBER like:{消息id} {用户id}\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("获取点赞的用户列表")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SMEMBERS like:{消息id}\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[a._v("获取点赞用户数")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SCARD like:{消息id}\n")])])]),s("h3",{attrs:{id:"集合操作实现微博微信关注模型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集合操作实现微博微信关注模型"}},[a._v("#")]),a._v(" 集合操作实现微博微信关注模型")]),a._v(" "),s("ol",[s("li",[a._v("我关注的人\nset1")]),a._v(" "),s("li",[a._v("恺b关注的人\nset2")]),a._v(" "),s("li",[a._v("笑笑关注的人\nset3")])]),a._v(" "),s("blockquote",[s("p",[a._v("同时关注的人")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SINTER set1 set2 set3\n")])])]),s("blockquote",[s("p",[a._v("关注的所有人")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SUNION set1 set2 set3\n")])])]),s("blockquote",[s("p",[a._v("只有我关注的人")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SDIFF set1 set2 set3\n")])])]),s("blockquote",[s("p",[a._v("我关注的笑笑也关注kaib ,返回1则表示，笑笑也关注了恺b")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("SISMEMBER set3 kaib\n")])])]),s("h3",{attrs:{id:"集合操作实现电商产品筛选"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集合操作实现电商产品筛选"}},[a._v("#")]),a._v(" 集合操作实现电商产品筛选")]),a._v(" "),s("h2",{attrs:{id:"zset"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#zset"}},[a._v("#")]),a._v(" ZSet")]),a._v(" "),s("h3",{attrs:{id:"热搜排行榜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#热搜排行榜"}},[a._v("#")]),a._v(" 热搜排行榜")]),a._v(" "),s("ol",[s("li",[a._v("点击新闻，将“唐艺昕肚子”这个微博，点击加1.")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ZINCRBY hotNews:20200316 1 唐艺昕肚子\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[a._v("展示当日排行版前十")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ZREVRANGE key start stop 0 9 WITHSCORES\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[a._v("七日搜索榜单计算")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ZUNIONSTORE hotNews:20200310-20200316 7 hotNews:20200310 hotNews:20200311 ... gitNews:20200316\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[a._v("展示七日排行榜")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ZREVRANGE hotNews:20200310-20200316 0 9 WITHSCORES\n")])])])])}),[],!1,null,null,null);t.default=r.exports}}]);